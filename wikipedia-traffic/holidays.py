import datetime

from workalendar.usa import UnitedStates
from workalendar.europe import UnitedKingdom, Germany, Austria, Switzerland, France, Belgium, Luxembourg, Spain
from workalendar.asia import Japan, Taiwan, Singapore
from workalendar.america import Mexico, Colombia


class CountryHolidays(object):
    def __init__(self, holidays):
        self.holidays = set(holidays)

    def is_holiday(self, dt):
        return dt in self.holidays


class India(CountryHolidays):
    def __init__(self):
        holidays = [datetime.date(2017, 1, 26),
                datetime.date(2017, 3, 13),
                datetime.date(2017, 4, 1),
                datetime.date(2017, 4, 9),
                datetime.date(2017, 4, 14),
                datetime.date(2017, 5, 10),
                datetime.date(2017, 7, 26),
                datetime.date(2017, 8, 15),
                datetime.date(2017, 9, 2),
                datetime.date(2017, 9, 30),
                datetime.date(2017, 10, 1),
                datetime.date(2017, 10, 2),
                datetime.date(2017, 10, 19),
                datetime.date(2017, 11, 4),
                datetime.date(2017, 12, 2),
                datetime.date(2017, 12, 25),
                datetime.date(2016, 1, 26),
                datetime.date(2016, 3, 24),
                datetime.date(2016, 3, 25),
                datetime.date(2016, 4, 1),
                datetime.date(2016, 4, 20),
                datetime.date(2016, 5, 21),
                datetime.date(2016, 7, 6),
                datetime.date(2016, 8, 15),
                datetime.date(2016, 9, 12),
                datetime.date(2016, 10, 2),
                datetime.date(2016, 10, 11),
                datetime.date(2016, 10, 12),
                datetime.date(2016, 10, 30),
                datetime.date(2016, 11, 14),
                datetime.date(2016, 12, 13),
                datetime.date(2016, 12, 25),
                datetime.date(2015, 1, 26),
                datetime.date(2015, 3, 6),
                datetime.date(2015, 4, 1),
                datetime.date(2015, 4, 2),
                datetime.date(2015, 5, 4),
                datetime.date(2015, 7, 18),
                datetime.date(2015, 8, 15),
                datetime.date(2015, 9, 5),
                datetime.date(2015, 9, 25),
                datetime.date(2015, 10, 2),
                datetime.date(2015, 10, 22),
                datetime.date(2015, 10, 24),
                datetime.date(2015, 11, 11),
                datetime.date(2015, 11, 25),
                datetime.date(2015, 12, 24),
                datetime.date(2015, 12, 25)]
        super(India, self).__init__(holidays)


class Pakistan(CountryHolidays):
    def __init__(self):
        holidays = [datetime.date(2017, 1, 2),
                    datetime.date(2017, 2, 5),
                    datetime.date(2017, 3, 1),
                    datetime.date(2017, 3, 23),
                    datetime.date(2017, 4, 4),
                    datetime.date(2017, 5, 1),
                    datetime.date(2017, 6, 26),
                    datetime.date(2017, 6, 27),
                    datetime.date(2017, 6, 28),
                    datetime.date(2017, 7, 3),
                    datetime.date(2017, 8, 14),
                    datetime.date(2017, 9, 1),
                    datetime.date(2017, 9, 2),
                    datetime.date(2017, 9, 3),
                    datetime.date(2017, 9, 4),
                    datetime.date(2017, 9, 30),
                    datetime.date(2017, 12, 1),
                    datetime.date(2017, 12, 25),
                    datetime.date(2016, 2, 5),
                    datetime.date(2016, 3, 23),
                    datetime.date(2016, 4, 4),
                    datetime.date(2016, 5, 1),
                    datetime.date(2016, 7, 1),
                    datetime.date(2016, 7, 5),
                    datetime.date(2016, 7, 6),
                    datetime.date(2016, 7, 7),
                    datetime.date(2016, 7, 8),
                    datetime.date(2016, 8, 14),
                    datetime.date(2016, 9, 12),
                    datetime.date(2016, 9, 13),
                    datetime.date(2016, 9, 14),
                    datetime.date(2016, 10, 11),
                    datetime.date(2016, 10, 12),
                    datetime.date(2016, 11, 9),
                    datetime.date(2016, 12, 12),
                    datetime.date(2016, 12, 16),
                    datetime.date(2016, 12, 25),
                    datetime.date(2015, 1, 3),
                    datetime.date(2015, 2, 5),
                    datetime.date(2015, 3, 23),
                    datetime.date(2015, 5, 1),
                    datetime.date(2015, 7, 17),
                    datetime.date(2015, 7, 18),
                    datetime.date(2015, 7, 19),
                    datetime.date(2015, 7, 20),
                    datetime.date(2015, 7, 21),
                    datetime.date(2015, 8, 14),
                    datetime.date(2015, 9, 24),
                    datetime.date(2015, 9, 25),
                    datetime.date(2015, 9, 26),
                    datetime.date(2015, 10, 14),
                    datetime.date(2015, 10, 23),
                    datetime.date(2015, 10, 24),
                    datetime.date(2015, 11, 9),
                    datetime.date(2015, 12, 16),
                    datetime.date(2015, 12, 24),
                    datetime.date(2015, 12, 25)]
        super(Pakistan, self).__init__(holidays)


class Philippines(CountryHolidays):
    def __init__(self):
        holidays = [
            datetime.date(2017, 1, 1),
            datetime.date(2017, 1, 2),
            datetime.date(2017, 1, 28),
            datetime.date(2017, 2, 25),
            datetime.date(2017, 4, 9),
            datetime.date(2017, 4, 13),
            datetime.date(2017, 4, 14),
            datetime.date(2017, 4, 15),
            datetime.date(2017, 4, 27),
            datetime.date(2017, 4, 28),
            datetime.date(2017, 5, 1),
            datetime.date(2017, 6, 12),
            datetime.date(2017, 6, 24),
            datetime.date(2017, 6, 26),
            datetime.date(2017, 8, 19),
            datetime.date(2017, 8, 21),
            datetime.date(2017, 8, 28),
            datetime.date(2017, 10, 31),
            datetime.date(2017, 11, 1),
            datetime.date(2017, 11, 30),
            datetime.date(2017, 12, 25),
            datetime.date(2017, 12, 30),
            datetime.date(2017, 12, 31),
            datetime.date(2016, 1, 1),
            datetime.date(2016, 1, 2),
            datetime.date(2016, 2, 8),
            datetime.date(2016, 2, 25),
            datetime.date(2016, 3, 24),
            datetime.date(2016, 3, 25),
            datetime.date(2016, 3, 26),
            datetime.date(2016, 4, 9),
            datetime.date(2016, 5, 1),
            datetime.date(2016, 5, 9),
            datetime.date(2016, 6, 12),
            datetime.date(2016, 6, 24),
            datetime.date(2016, 7, 6),
            datetime.date(2016, 8, 19),
            datetime.date(2016, 8, 21),
            datetime.date(2016, 8, 29),
            datetime.date(2016, 9, 12),
            datetime.date(2016, 10, 31),
            datetime.date(2016, 11, 1),
            datetime.date(2016, 11, 30),
            datetime.date(2016, 12, 24),
            datetime.date(2016, 12, 25),
            datetime.date(2016, 12, 26),
            datetime.date(2016, 12, 30),
            datetime.date(2016, 12, 31),
            datetime.date(2015, 1, 1),
            datetime.date(2015, 1, 2),
            datetime.date(2015, 2, 19),
            datetime.date(2015, 2, 25),
            datetime.date(2015, 4, 2),
            datetime.date(2015, 4, 3),
            datetime.date(2015, 4, 4),
            datetime.date(2015, 4, 9),
            datetime.date(2015, 5, 1),
            datetime.date(2015, 6, 12),
            datetime.date(2015, 6, 24),
            datetime.date(2015, 7, 17),
            datetime.date(2015, 8, 21),
            datetime.date(2015, 8, 31),
            datetime.date(2015, 9, 25),
            datetime.date(2015, 11, 1),
            datetime.date(2015, 11, 18),
            datetime.date(2015, 11, 19),
            datetime.date(2015, 11, 30),
            datetime.date(2015, 12, 24),
            datetime.date(2015, 12, 25),
            datetime.date(2015, 12, 30),
            datetime.date(2015, 12, 31)]
        super(Philippines, self).__init__(holidays)


class China(CountryHolidays):
    def __init__(self):
        holidays = [
            datetime.date(2017, 1, 1),
            datetime.date(2017, 1, 2),
            datetime.date(2017, 1, 27),
            datetime.date(2017, 1, 28),
            datetime.date(2017, 1, 29),
            datetime.date(2017, 1, 30),
            datetime.date(2017, 1, 31),
            datetime.date(2017, 2, 1),
            datetime.date(2017, 2, 2),
            datetime.date(2017, 4, 2),
            datetime.date(2017, 4, 3),
            datetime.date(2017, 4, 4),
            datetime.date(2017, 5, 1),
            datetime.date(2017, 5, 28),
            datetime.date(2017, 5, 29),
            datetime.date(2017, 5, 30),
            datetime.date(2017, 10, 1),
            datetime.date(2017, 10, 2),
            datetime.date(2017, 10, 3),
            datetime.date(2017, 10, 4),
            datetime.date(2017, 10, 4),
            datetime.date(2017, 10, 5),
            datetime.date(2017, 10, 6),
            datetime.date(2016, 1, 1),
            datetime.date(2016, 2, 7),
            datetime.date(2016, 2, 8),
            datetime.date(2016, 2, 9),
            datetime.date(2016, 2, 10),
            datetime.date(2016, 2, 11),
            datetime.date(2016, 2, 12),
            datetime.date(2016, 2, 13),
            datetime.date(2016, 3, 8),
            datetime.date(2016, 4, 4),
            datetime.date(2016, 5, 1),
            datetime.date(2016, 5, 2),
            datetime.date(2016, 6, 9),
            datetime.date(2016, 6, 10),
            datetime.date(2016, 6, 11),
            datetime.date(2016, 9, 15),
            datetime.date(2016, 9, 16),
            datetime.date(2016, 10, 1),
            datetime.date(2016, 10, 2),
            datetime.date(2016, 10, 3),
            datetime.date(2016, 10, 4),
            datetime.date(2016, 10, 5),
            datetime.date(2016, 10, 6),
            datetime.date(2016, 10, 7),
            datetime.date(2016, 10, 9),
            datetime.date(2015, 1, 1),
            datetime.date(2015, 1, 2),
            datetime.date(2015, 1, 3),
            datetime.date(2015, 2, 18),
            datetime.date(2015, 2, 19),
            datetime.date(2015, 2, 20),
            datetime.date(2015, 2, 21),
            datetime.date(2015, 2, 22),
            datetime.date(2015, 2, 23),
            datetime.date(2015, 2, 24),
            datetime.date(2015, 3, 8),
            datetime.date(2015, 4, 5),
            datetime.date(2015, 4, 6),
            datetime.date(2015, 5, 1),
            datetime.date(2015, 5, 2),
            datetime.date(2015, 5, 3),
            datetime.date(2015, 6, 20),
            datetime.date(2015, 6, 21),
            datetime.date(2015, 6, 22),
            datetime.date(2015, 9, 3),
            datetime.date(2015, 9, 4),
            datetime.date(2015, 9, 27),
            datetime.date(2015, 10, 1),
            datetime.date(2015, 10, 2),
            datetime.date(2015, 10, 3),
            datetime.date(2015, 10, 4),
            datetime.date(2015, 10, 5),
            datetime.date(2015, 10, 6),
            datetime.date(2015, 10, 7),
            datetime.date(2015, 10, 21)]
        super(China, self).__init__(holidays)


class Russia(CountryHolidays):
    def __init__(self):
        holidays = [
            datetime.date(2017, 1, 1),
            datetime.date(2017, 1, 2),
            datetime.date(2017, 1, 3),
            datetime.date(2017, 1, 4),
            datetime.date(2017, 1, 5),
            datetime.date(2017, 1, 6),
            datetime.date(2017, 1, 7),
            datetime.date(2017, 2, 23),
            datetime.date(2017, 2, 24),
            datetime.date(2017, 3, 8),
            datetime.date(2017, 5, 1),
            datetime.date(2017, 5, 8),
            datetime.date(2017, 5, 9),
            datetime.date(2017, 6, 12),
            datetime.date(2017, 11, 4),
            datetime.date(2017, 11, 6),
            datetime.date(2016, 1, 1),
            datetime.date(2016, 1, 4),
            datetime.date(2016, 1, 5),
            datetime.date(2016, 1, 6),
            datetime.date(2016, 1, 7),
            datetime.date(2016, 2, 22),
            datetime.date(2016, 2, 23),
            datetime.date(2016, 3, 8),
            datetime.date(2016, 5, 1),
            datetime.date(2016, 5, 9),
            datetime.date(2016, 6, 12),
            datetime.date(2016, 6, 13),
            datetime.date(2016, 11, 4),
            datetime.date(2015, 1, 1),
            datetime.date(2015, 1, 2),
            datetime.date(2015, 1, 5),
            datetime.date(2015, 1, 6),
            datetime.date(2015, 1, 7),
            datetime.date(2015, 1, 8),
            datetime.date(2015, 1, 9),
            datetime.date(2015, 2, 23),
            datetime.date(2015, 3, 9),
            datetime.date(2015, 5, 1),
            datetime.date(2015, 5, 4),
            datetime.date(2015, 5, 9),
            datetime.date(2015, 5, 11),
            datetime.date(2015, 6, 12),
            datetime.date(2015, 11, 4)]
        super(Russia, self).__init__(holidays)


feature_countries = [
    # English
    UnitedStates(), India(), Pakistan(), Philippines(), UnitedKingdom(),

    # Japanese
    Japan(),

    # German
    Germany(), Austria(), Switzerland(),

    # French
    France(), Belgium(), Luxembourg(),

    # Mandarin
    Taiwan(), Singapore(), China(),

    # Spanish
    Spain(), Mexico(), Colombia(),

    # Russian
    Russia()
]


def holiday_features_for_date(dt):
    features = dict()
    for country in feature_countries:
        features["{} on holiday".format(type(country).__name__)] = country.is_holiday(dt)
    return features
